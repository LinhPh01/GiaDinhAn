import{t as p}from"../../../external/@swc/helpers/src/_async_to_generator.mjs.js.ae57f58a.js";import{A as h}from"../../token.js.34b36f63.js";import{o as y,T as b}from"../../../constants.js.e7b682ef.js";import{w}from"../../../utils/common.js.81cce464.js";import{e as v}from"../../../external/tslib/tslib.es6.js.20b0ea63.js";var _,E=(_=p(function(i,s){var c,r,u,e;return v(this,function(t){switch(t.label){case 0:return(r=s)?[3,2]:[4,w()];case 1:r=!t.sent(),t.label=2;case 2:return c=r,[4,h.getAccessToken(c)];case 3:return u=t.sent(),e="id,name,user_id_by_oa,is_sensitive",e=i?"".concat(e,",picture.type(").concat(i,")"):"".concat(e,",picture"),[4,fetch("".concat(y.GET_USER_INFO,"?fields=").concat(e,"&miniapp_id=").concat(b),{headers:{access_token:u||""}}).then(function(){var m=p(function(l){var o,a,n,d;return v(this,function(f){switch(f.label){case 0:return[4,l.json()];case 1:return n=f.sent(),d=n==null?void 0:n.user_id_by_oa,[2,{id:n==null?void 0:n.id,name:(n==null?void 0:n.name)||"",avatar:(n==null||(o=n.picture)===null||o===void 0||(a=o.data)===null||a===void 0?void 0:a.url)||"",idByOA:d,followedOA:n==null?void 0:n.is_follower,isSensitive:n==null?void 0:n.is_sensitive}]}})});return function(l){return m.apply(this,arguments)}}())];case 4:return[2,t.sent()]}})}),function(i,s){return _.apply(this,arguments)});export{E as c};
