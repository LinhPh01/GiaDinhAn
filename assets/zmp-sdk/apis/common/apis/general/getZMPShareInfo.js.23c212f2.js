import{t as P}from"../../../external/@swc/helpers/src/_async_to_generator.mjs.js.ae57f58a.js";import{t as l}from"../../../external/@swc/helpers/src/_object_spread.mjs.js.864104b0.js";import{e as v}from"../../../external/@swc/helpers/src/_object_spread_props.mjs.js.926c90b1.js";import{o as A}from"../../../utils/response.js.aae1b78a.js";import{A as E,O as R,o as _}from"../../../constants.js.e7b682ef.js";import{e as I}from"../../../external/tslib/tslib.es6.js.20b0ea63.js";var u,V=(u=P(function(h,p,d,m,f,r){var o,t,c,a,s,e,w,n;return I(this,function(i){switch(i.label){case 0:return c=new URL(location.href),a=new URLSearchParams,s="".concat(c.pathname.replace(E,"")).concat(c.search),r&&(s="/".concat(h).concat(r[0]==="/"?"":"/").concat(r)),!(e=new URL("".concat(R).concat(s))).searchParams.has("env")&&((o=window.APP_ENV)===null||o===void 0?void 0:o.length)>0&&e.searchParams.set("env",window.APP_ENV),!e.searchParams.has("version")&&((t=window.APP_VERSION)===null||t===void 0?void 0:t.length)>0&&e.searchParams.set("version",window.APP_VERSION),a.append("title",d),a.append("description",m||""),a.append("thumbnail",f||""),a.append("url",e.href),a.append("accessToken",p||""),w={headers:{"Content-Type":"application/x-www-form-urlencoded"}},[4,fetch(_.CREATE_SHARE_LINK,l({method:"POST",body:a},w))];case 1:return[4,i.sent().json()];case 2:if(!(n=i.sent())||n.err!==0)throw A.error.cannotGetShareInfo();return e.search="".concat(e.search,"&zshareId=").concat(n.data.shareId),[2,v(l({},n.data),{shareableLink:e.href})]}})}),function(h,p,d,m,f,r){return u.apply(this,arguments)});export{V as i};
